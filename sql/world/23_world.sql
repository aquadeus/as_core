-- Grelda the Hag lootfix
DELETE FROM `creature_loot_template` WHERE `entry`=95123;
INSERT INTO `creature_loot_template` (`entry`, `item`, `ChanceOrQuestChance`, `lootmode`, `groupid`, `mincountOrRef`, `maxcount`) VALUES
(95123, 136785, -54, 1, 0, 1, 1),
(95123, 130122, 39, 1, 0, 1, 1),
(95123, 138839, 10, 1, 0, 1, 1),
(95123, 139528, 0.12, 1, 0, 1, 1),
(95123, 139526, 0.1, 1, 0, 1, 1),
(95123, 138009, 0.03, 1, 0, 1, 1),
(95123, 139527, 0.01, 1, 0, 1, 1),
(95123, 124437, 17, 1, 0, 1, 3),
(95123, 138781, 0.7, 1, 0, 1, 1),
(95123, 140222, 0.4, 1, 0, 1, 1),
(95123, 121215, 0.3, 1, 0, 1, 1),
(95123, 121335, 0.3, 1, 0, 1, 1),
(95123, 121332, 0.3, 1, 0, 1, 1),
(95123, 121342, 0.3, 1, 0, 1, 1),
(95123, 121354, 0.3, 1, 0, 1, 1),
(95123, 121356, 0.3, 1, 0, 1, 1),
(95123, 121358, 0.3, 1, 0, 1, 1),
(95123, 121213, 0.2, 1, 0, 1, 1),
(95123, 121211, 0.2, 1, 0, 1, 1),
(95123, 141290, 0.2, 1, 0, 1, 1),
(95123, 121337, 0.2, 1, 0, 1, 1),
(95123, 121350, 0.2, 1, 0, 1, 1),
(95123, 121371, 0.2, 1, 0, 1, 1),
(95123, 121344, 0.2, 1, 0, 1, 1),
(95123, 121359, 0.2, 1, 0, 1, 1),
(95123, 121184, 0.18, 1, 0, 1, 1),
(95123, 121334, 0.18, 1, 0, 1, 1),
(95123, 121339, 0.17, 1, 0, 1, 1),
(95123, 121365, 0.17, 1, 0, 1, 1),
(95123, 121370, 0.17, 1, 0, 1, 1),
(95123, 140221, 0.16, 1, 0, 1, 1),
(95123, 140226, 0.16, 1, 0, 1, 1),
(95123, 121363, 0.16, 1, 0, 1, 1),
(95123, 121345, 0.16, 1, 0, 1, 1),
(95123, 121362, 0.16, 1, 0, 1, 1),
(95123, 140224, 0.15, 1, 0, 1, 1),
(95123, 121208, 0.15, 1, 0, 1, 1),
(95123, 121210, 0.13, 1, 0, 1, 1),
(95123, 121366, 0.13, 1, 0, 1, 1),
(95123, 121368, 0.13, 1, 0, 1, 1),
(95123, 121349, 0.13, 1, 0, 1, 1),
(95123, 121218, 0.12, 1, 0, 1, 1),
(95123, 121205, 0.12, 1, 0, 1, 1),
(95123, 121361, 0.12, 1, 0, 1, 1),
(95123, 121369, 0.12, 1, 0, 1, 1),
(95123, 121214, 0.11, 1, 0, 1, 1),
(95123, 121168, 0.11, 1, 0, 1, 1),
(95123, 121193, 0.11, 1, 0, 1, 1),
(95123, 121341, 0.11, 1, 0, 1, 1),
(95123, 121346, 0.11, 1, 0, 1, 1),
(95123, 140227, 0.1, 1, 0, 1, 1),
(95123, 121206, 0.1, 1, 0, 1, 1),
(95123, 121169, 0.1, 1, 0, 1, 1),
(95123, 140225, 0.1, 1, 0, 1, 1),
(95123, 121189, 0.1, 1, 0, 1, 1),
(95123, 121177, 0.1, 1, 0, 1, 1),
(95123, 121373, 0.1, 1, 0, 1, 1),
(95123, 121355, 0.1, 1, 0, 1, 1),
(95123, 121212, 0.09, 1, 0, 1, 1),
(95123, 121405, 0.09, 1, 0, 1, 1),
(95123, 121352, 0.09, 1, 0, 1, 1),
(95123, 121172, 0.08, 1, 0, 1, 1),
(95123, 121181, 0.08, 1, 0, 1, 1),
(95123, 121179, 0.08, 1, 0, 1, 1),
(95123, 121173, 0.07, 1, 0, 1, 1),
(95123, 140220, 0.07, 1, 0, 1, 1),
(95123, 121360, 0.07, 1, 0, 1, 1),
(95123, 121209, 0.06, 1, 0, 1, 1),
(95123, 121188, 0.06, 1, 0, 1, 1),
(95123, 121219, 0.05, 1, 0, 1, 1),
(95123, 121207, 0.05, 1, 0, 1, 1),
(95123, 121166, 0.05, 1, 0, 1, 1),
(95123, 121187, 0.05, 1, 0, 1, 1),
(95123, 121364, 0.05, 1, 0, 1, 1),
(95123, 121372, 0.05, 1, 0, 1, 1),
(95123, 121217, 0.04, 1, 0, 1, 1),
(95123, 121180, 0.04, 1, 0, 1, 1),
(95123, 121338, 0.04, 1, 0, 1, 1),
(95123, 121402, 0.04, 1, 0, 1, 1),
(95123, 121367, 0.04, 1, 0, 1, 1),
(95123, 121216, 0.03, 1, 0, 1, 1),
(95123, 121167, 0.03, 1, 0, 1, 1),
(95123, 141291, 0.03, 1, 0, 1, 1),
(95123, 121410, 0.03, 1, 0, 1, 1),
(95123, 121384, 0.03, 1, 0, 1, 1),
(95123, 121392, 0.03, 1, 0, 1, 1),
(95123, 121348, 0.03, 1, 0, 1, 1),
(95123, 121393, 0.03, 1, 0, 1, 1),
(95123, 121183, 0.02, 1, 0, 1, 1),
(95123, 121333, 0.02, 1, 0, 1, 1),
(95123, 121170, 0.01, 1, 0, 1, 1),
(95123, 121186, 0.01, 1, 0, 1, 1),
(95123, 121385, 0.01, 1, 0, 1, 1),
(95123, 121406, 0.01, 1, 0, 1, 1),
(95123, 121409, 0.01, 1, 0, 1, 1);

UPDATE `creature_template` SET `lootid`='95123' WHERE `entry`='95123';

-- Legion containers lootfix
DELETE FROM `item_loot_template` WHERE `entry`='141344';
INSERT INTO `item_loot_template` (`Entry`, `Item`, `ChanceOrQuestChance`, `LootMode`, `Groupid`, `MinCountOrRef`, `MaxCount`) VALUES
(141344, 139026, 4.8, 1, 0, 1, 1),
(141344, 139025, 14, 1, 0, 1, 1),
(141344, 139020, 13, 1, 0, 1, 1),
(141344, 139023, 12, 1, 0, 1, 1),
(141344, 139024, 11, 1, 0, 1, 1),
(141344, 139021, 12, 1, 0, 1, 1),
(141344, 140581, 0.04, 1, 0, 1, 1);

DELETE FROM `item_loot_template` WHERE `entry`='140225';
INSERT INTO `item_loot_template` (`Entry`, `Item`, `ChanceOrQuestChance`, `LootMode`, `Groupid`, `MinCountOrRef`, `MaxCount`) VALUES
(140225, 123919, 48, 1, 0, 10, 20),
(140225, 123918, 48, 1, 0, 10, 20),
(140225, 124444, 1.2, 1, 0, 1, 1),
(140225, 121356, 2, 1, 0, 1, 1),
(140225, 121342, 2, 1, 0, 1, 1),
(140225, 121355, 2, 1, 0, 1, 1),
(140225, 121338, 2, 1, 0, 1, 1),
(140225, 121351, 2, 1, 0, 1, 1),
(140225, 121336, 2, 1, 0, 1, 1),
(140225, 121341, 2, 1, 0, 1, 1),
(140225, 121343, 2, 1, 0, 1, 1),
(140225, 121362, 2, 1, 0, 1, 1),
(140225, 121344, 2, 1, 0, 1, 1),
(140225, 121367, 2, 1, 0, 1, 1),
(140225, 121334, 2, 1, 0, 1, 1),
(140225, 121353, 2, 1, 0, 1, 1),
(140225, 121360, 2, 1, 0, 1, 1),
(140225, 121359, 2, 1, 0, 1, 1),
(140225, 121335, 2, 1, 0, 1, 1),
(140225, 121366, 2, 1, 0, 1, 1),
(140225, 121363, 2, 1, 0, 1, 1),
(140225, 121350, 2, 1, 0, 1, 1),
(140225, 121365, 2, 1, 0, 1, 1),
(140225, 121340, 2, 1, 0, 1, 1),
(140225, 121333, 2, 1, 0, 1, 1),
(140225, 121352, 2, 1, 0, 1, 1),
(140225, 121346, 2, 1, 0, 1, 1),
(140225, 121347, 2, 1, 0, 1, 1),
(140225, 121349, 2, 1, 0, 1, 1),
(140225, 121354, 2, 1, 0, 1, 1),
(140225, 121332, 2, 1, 0, 1, 1),
(140225, 121337, 2, 1, 0, 1, 1),
(140225, 121373, 2, 1, 0, 1, 1),
(140225, 121368, 2, 1, 0, 1, 1),
(140225, 121357, 2, 1, 0, 1, 1),
(140225, 121358, 2, 1, 0, 1, 1),
(140225, 121372, 2, 1, 0, 1, 1),
(140225, 121348, 2, 1, 0, 1, 1),
(140225, 121345, 2, 1, 0, 1, 1),
(140225, 121339, 2, 1, 0, 1, 1),
(140225, 121370, 2, 1, 0, 1, 1),
(140225, 121364, 2, 1, 0, 1, 1),
(140225, 121371, 2, 1, 0, 1, 1),
(140225, 121361, 2, 1, 0, 1, 1),
(140225, 121369, 2, 1, 0, 1, 1),
(140225, 134323, 0.2, 1, 0, 1, 1),
(140225, 121406, 0.2, 1, 0, 1, 1),
(140225, 139118, 0.2, 1, 0, 1, 1),
(140225, 139098, 0.2, 1, 0, 1, 1),
(140225, 134214, 0.2, 1, 0, 1, 1),
(140225, 134301, 0.2, 1, 0, 1, 1),
(140225, 121408, 0.2, 1, 0, 1, 1),
(140225, 121387, 0.2, 1, 0, 1, 1),
(140225, 121328, 0.2, 1, 0, 1, 1),
(140225, 121288, 0.2, 1, 0, 1, 1),
(140225, 139129, 0.2, 1, 0, 1, 1),
(140225, 121409, 0.2, 1, 0, 1, 1),
(140225, 121376, 0.2, 1, 0, 1, 1),
(140225, 121388, 0.2, 1, 0, 1, 1),
(140225, 134243, 0.2, 1, 0, 1, 1),
(140225, 121394, 0.2, 1, 0, 1, 1),
(140225, 134396, 0.2, 1, 0, 1, 1),
(140225, 134319, 0.2, 1, 0, 1, 1),
(140225, 134329, 0.2, 1, 0, 1, 1),
(140225, 134173, 0.2, 1, 0, 1, 1),
(140225, 134352, 0.2, 1, 0, 1, 1),
(140225, 121389, 0.2, 1, 0, 1, 1); 


-- https://forum.wowcircle.net/showthread.php?t=779433
select linked_id from creature where id = 104519 into @boss1;
select linked_id from creature where id = 104521 into @boss2;
select linked_id from creature where id = 104522 into @boss3;

replace INTO `creature_formations` (`leaderLinkedId`, `memberLinkedId`, `dist`, `angle`, `groupAI`) VALUES
(@boss1, @boss1, 0, 0, 0),
(@boss1, @boss2, 5, 315, 515),
(@boss1, @boss3, 5, 45, 515);

select guid from creature where id = 104519 into @gboss1;
select guid from creature where id = 104521 into @gboss2;
select guid from creature where id = 104522 into @gboss3;

delete from linked_respawn where linkedGuid = @gboss1;
insert INTO `linked_respawn` (`guid`, `linkedGuid`, `linkType`) VALUES 
(@gboss2, @gboss1, 0),
(@gboss3, @gboss1, 0);

delete from creature_addon where linked_id = '1C6AF05A9D2D49E4DD84F5FCCC739546F096EFC3';
replace INTO `creature_addon` (`linked_id`, `path_id`, `mount`, `bytes1`, `bytes2`, `emote`, `aiAnimKit`, `movementAnimKit`, `meleeAnimKit`, `auras`) VALUES 
(@boss1, @gboss1*100, 0, 0, 0, 0, 0, 0, 0, NULL);

update creature set spawntimesecs = 1200 where id in (104521,104522);
update creature set movementtype = 2 where id in (104519);

delete from smart_scripts where entryorguid in (104519,104521,104522);
INSERT INTO `smart_scripts` (`entryorguid`, `source_type`, `id`, `link`, `event_type`, `event_phase_mask`, `event_chance`, `event_flags`, `event_spawnMask`, `event_param1`, `event_param2`, `event_param3`, `event_param4`, `event_param5`, `action_type`, `action_param1`, `action_param2`, `action_param3`, `action_param4`, `action_param5`, `action_param6`, `target_type`, `target_param1`, `target_param2`, `target_param3`, `target_x`, `target_y`, `target_z`, `target_o`, `comment`) VALUES 
(104519, 0, 0, 0, 25, 0, 100, 0, 0, 0, 0, 0, 0, 0, 43, 106029, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 'Mount Manasaber'),
(104519, 0, 1, 0, 4, 0, 100, 0, 0, 0, 0, 0, 0, 0, 43, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 'Dismount Manasaber'),
(104519, 0, 2, 0, 0, 0, 100, 0, 0, 6000, 6000, 35000, 35000, 0, 11, 207173, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 'Cast Mirror Image'),
(104519, 0, 3, 0, 0, 0, 100, 0, 0, 8500, 8500, 37500, 37500, 0, 11, 207173, 2, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 'Cast Mirror Image'),
(104519, 0, 4, 0, 0, 0, 100, 0, 0, 8500, 8500, 37500, 37500, 0, 11, 207173, 2, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 'Cast Mirror Image'),
(104519, 0, 5, 0, 6, 0, 100, 0, 0, 0, 0, 0, 0, 0, 33, 114268, 0, 0, 0, 0, 0, 18, 50, 0, 0, 0, 0, 0, 0, 'Give Killcredit'),
(104519, 0, 6, 0, 4, 0, 100, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 'Talk'),
(104519, 0, 7, 0, 6, 0, 100, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 'Talk'),

(104521, 0, 0, 0, 25, 0, 100, 0, 0, 0, 0, 0, 0, 0, 43, 106029, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 'Mount Manasaber'),
(104521, 0, 1, 0, 4, 0, 100, 0, 0, 0, 0, 0, 0, 0, 43, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 'Dismount Manasaber'),
(104521, 0, 2, 0, 0, 0, 100, 0, 0, 6000, 6000, 35000, 35000, 0, 11, 207199, 0, 0, 0, 0, 0, 11, 104521, 0, 0, 0, 0, 0, 0, 'Cast Arcane Barrier on Colerian'),
(104521, 0, 3, 0, 0, 0, 100, 0, 0, 12000, 12000, 25000, 25000, 0, 11, 207199, 0, 0, 0, 0, 0, 11, 104522, 0, 0, 0, 0, 0, 0, 'Cast Arcane Barrier on Selenyi'),
(104521, 0, 4, 0, 0, 0, 100, 0, 0, 2000, 2000, 4500, 4500, 0, 11, 207196, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 'Cast Arcane Blast'),
(104521, 0, 5, 0, 6, 0, 100, 0, 0, 0, 0, 0, 0, 0, 33, 114268, 0, 0, 0, 0, 0, 18, 50, 0, 0, 0, 0, 0, 0, 'Give Killcredit'),
(104521, 0, 6, 0, 4, 0, 100, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 'Talk'),
(104521, 0, 7, 0, 6, 0, 100, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 'Talk'),

(104522, 0, 0, 0, 25, 0, 100, 0, 0, 0, 0, 0, 0, 0, 43, 106029, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 'Mount Manasaber'),
(104522, 0, 1, 0, 4, 0, 100, 0, 0, 0, 0, 0, 0, 0, 43, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 'Dismount Manasaber'),
(104522, 0, 2, 0, 0, 0, 100, 0, 0, 2000, 2000, 24500, 24500, 0, 11, 207300, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 'Cast Temporal Shift'),
(104522, 0, 3, 0, 6, 0, 100, 0, 0, 0, 0, 0, 0, 0, 33, 114268, 0, 0, 0, 0, 0, 18, 50, 0, 0, 0, 0, 0, 0, 'Give Killcredit'),
(104522, 0, 4, 0, 4, 0, 100, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 'Talk'),
(104522, 0, 5, 0, 6, 0, 100, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 'Talk');

delete from conditions where SourceEntry in (104519,104521,104522) and SourceTypeOrReferenceId = 22;
INSERT INTO conditions (SourceTypeOrReferenceId, SourceGroup, SourceEntry, SourceId, ElseGroup, ConditionTypeOrReference, ConditionTarget, ConditionValue1, ConditionValue2, ConditionValue3, NegativeCondition, ErrorTextId, ScriptName, Comment) VALUES 
(22, 6, 104519, 0, 0, 29, 0, 104521, 50, 0, 1, 0, '', 'Smart if near no 104521 creature'),
(22, 6, 104519, 0, 0, 29, 0, 104522, 50, 0, 1, 0, '', 'Smart if near no 104522 creature'),

(22, 6, 104521, 0, 0, 29, 0, 104519, 50, 0, 1, 0, '', 'Smart if near no 104519 creature'),
(22, 6, 104521, 0, 0, 29, 0, 104522, 50, 0, 1, 0, '', 'Smart if near no 104522 creature'),

(22, 4, 104522, 0, 0, 29, 0, 104519, 50, 0, 1, 0, '', 'Smart if near no 104519 creature'),
(22, 4, 104522, 0, 0, 29, 0, 104521, 50, 0, 1, 0, '', 'Smart if near no 104521 creature');

delete from waypoint_data where id = @gboss1*100;
INSERT INTO `waypoint_data` (`id`, `point`, `position_x`, `position_y`, `position_z`) VALUES 
(@gboss1*100, 1 , 1289.24, 5367.77, 97.1965),
(@gboss1*100, 2 , 1327.69, 5354.14, 99.1985),
(@gboss1*100, 3 , 1359.45, 5341.78, 101.742),
(@gboss1*100, 4 , 1395.75, 5325.82, 104.859),
(@gboss1*100, 5 , 1418.38, 5313.27, 107.107),
(@gboss1*100, 6 , 1442.51, 5298.92, 109.753),
(@gboss1*100, 7 , 1461.87, 5291.63, 111.593),
(@gboss1*100, 8 , 1483.03, 5276.29, 114.033),
(@gboss1*100, 9 , 1500.26, 5260.55, 116.319),
(@gboss1*100, 10, 1521.06, 5238.45, 117.865);

delete from quest_template_objective where questid = 41697;
INSERT INTO `quest_template_objective` (`ID`, `QuestID`, `Type`, `Order`, `Index`, `ObjectID`, `Amount`, `Flags`, `Flags2`, `ProgressBarWeight`, `Description`, `VisualEffects`, `VerifiedBuild`) VALUES 
(282683, 41697, 0, 0, 0, 114268, 1, 1, 0, 0, 'Тройка всадников убита', '', 1);

update quest_template set flags = 36766720 where id in (41697);